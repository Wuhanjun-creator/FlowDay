<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>应用设置 - FlowDay</title>
    <link rel="stylesheet" href="styles.css" />
    <script>
      // 预加载主题 - 在页面渲染前应用，防止闪烁
      (function() {
        const cachedTheme = localStorage.getItem('flowday-current-theme');
        if (cachedTheme) {
          try {
            const theme = JSON.parse(cachedTheme);
            const root = document.documentElement;
            root.style.setProperty('--bg', theme.background);
            root.style.setProperty('--primary', theme.primary);
            root.style.setProperty('--accent', theme.accent);
            // 计算派生颜色
            const isDark = parseInt(theme.background.replace('#', ''), 16) < 0x888888;
            root.style.setProperty('--text', isDark ? '#f5f5f5' : '#111111');
            root.style.setProperty('--muted', isDark ? '#a1a1aa' : '#6b7280');
            root.style.setProperty('--panel', isDark ? 'rgba(255,255,255,0.06)' : 'rgba(255,255,255,0.7)');
            root.style.setProperty('--panel-strong', isDark ? 'rgba(255,255,255,0.1)' : 'rgba(255,255,255,0.92)');
            root.style.setProperty('--panel-deep', isDark ? '#0f0f0f' : '#e6e4dc');
            root.style.setProperty('--border', isDark ? 'rgba(255,255,255,0.08)' : 'rgba(0,0,0,0.08)');
            root.style.setProperty('--accent-soft', theme.accent + '40');
            root.style.setProperty('--glow', theme.accent + '26');
            root.style.setProperty('--button-solid', isDark ? '#ffffff' : '#111111');
            root.style.colorScheme = isDark ? 'dark' : 'light';
          } catch (e) {}
        }
      })();
    </script>
  </head>
  <body class="page-app">
    <div class="ambient" aria-hidden="true">
      <span class="orb orb-a"></span>
      <span class="orb orb-b"></span>
      <span class="orb orb-c"></span>
    </div>

    <div class="app-shell">
      <aside class="sidebar">
        <div class="brand">
          <div class="brand-mark">FlowDay</div>
          <div class="brand-tagline tagline-rotator tagline-small">
            <span>让每一天<br />在正确的节律中慢慢<br />绽放。</span>
            <span>Let every day <br bloom slowly,<br />in the right rhythm.</span>
          </div>
        </div>
        <nav class="nav" aria-label="primary">
          <a href="overview.html" class="nav-item" data-nav="overview">
            <span data-i18n="navOverview">今日概览</span>
          </a>
          <a href="insights.html" class="nav-item" data-nav="insights">
            <span data-i18n="navInsights">节奏洞察</span>
          </a>
          <a href="journal.html" class="nav-item" data-nav="journal">
            <span data-i18n="navJournal">记录今日</span>
          </a>
          <a href="habits.html" class="nav-item" data-nav="habits">
            <span data-i18n="navHabits">习惯跟踪</span>
          </a>
          <a href="quicklist.html" class="nav-item" data-nav="quicklist">
            <span data-i18n="navQuicklist">即时清单</span>
          </a>
          <a href="profile.html" class="nav-item active" data-nav="profile">
            <span data-i18n="navProfile">个人资料</span>
          </a>
          <a href="settings.html" class="nav-item" data-nav="settings">
            <span data-i18n="navSettings">应用设置</span>
          </a>
        </nav>
      </aside>

      <div class="app-main">
        <header class="topbar">
          <div class="welcome-block">
            <h2 class="greeting" id="greeting"></h2>
            <div class="date-value" id="dateLabel"></div>
          </div>
        </header>

        <main class="content">
          <div class="page page-settings active">
            <section class="card settings">
              <div class="card-head">
                <h2 data-i18n="settingsTitle">应用设置</h2>
                <span class="chip" data-i18n="settingsHint">自定义您的节奏</span>
              </div>
              <div class="settings-grid">
                <div class="settings-block">
                  <h3 data-i18n="language">语言</h3>
                  <div class="custom-select" id="langSelectContainer">
                    <div class="custom-select-header">
                      <span class="custom-select-value" id="langSelectValue">中文</span>
                      <span class="custom-select-arrow">▼</span>
                    </div>
                    <div class="custom-select-options" id="langSelectOptions">
                      <div class="custom-select-option" data-value="zh">中文</div>
                      <div class="custom-select-option" data-value="en">English</div>
                    </div>
                    <input type="hidden" id="langSelect" value="zh">
                  </div>
                </div>
                <div class="settings-block">
                  <h3 data-i18n="timezone">时区</h3>
                  <div class="custom-select" id="timezoneSelectContainer">
                    <div class="custom-select-header">
                      <span class="custom-select-value" id="timezoneSelectValue">北京时间 (GMT+8)</span>
                      <span class="custom-select-arrow">▼</span>
                    </div>
                    <div class="custom-select-options" id="timezoneSelectOptions">
                      <div class="custom-select-option" data-value="Asia/Shanghai">北京时间 (GMT+8)</div>
                      <div class="custom-select-option" data-value="Asia/Tokyo">东京时间 (GMT+9)</div>
                      <div class="custom-select-option" data-value="Asia/Seoul">首尔时间 (GMT+9)</div>
                      <div class="custom-select-option" data-value="Asia/Singapore">新加坡时间 (GMT+8)</div>
                      <div class="custom-select-option" data-value="Asia/Kolkata">孟买时间 (GMT+5:30)</div>
                      <div class="custom-select-option" data-value="Asia/Dubai">迪拜时间 (GMT+4)</div>
                      <div class="custom-select-option" data-value="Europe/London">伦敦时间 (GMT+0)</div>
                      <div class="custom-select-option" data-value="Europe/Paris">巴黎时间 (GMT+1)</div>
                      <div class="custom-select-option" data-value="Europe/Berlin">柏林时间 (GMT+1)</div>
                      <div class="custom-select-option" data-value="Europe/Moscow">莫斯科时间 (GMT+3)</div>
                      <div class="custom-select-option" data-value="America/New_York">纽约时间 (GMT-5)</div>
                      <div class="custom-select-option" data-value="America/Chicago">芝加哥时间 (GMT-6)</div>
                      <div class="custom-select-option" data-value="America/Los_Angeles">洛杉矶时间 (GMT-8)</div>
                      <div class="custom-select-option" data-value="America/Toronto">多伦多时间 (GMT-5)</div>
                      <div class="custom-select-option" data-value="America/Mexico_City">墨西哥城时间 (GMT-6)</div>
                      <div class="custom-select-option" data-value="America/Sao_Paulo">圣保罗时间 (GMT-3)</div>
                      <div class="custom-select-option" data-value="America/Argentina/Buenos_Aires">布宜诺斯艾利斯时间 (GMT-3)</div>
                      <div class="custom-select-option" data-value="America/Santiago">圣地亚哥时间 (GMT-4)</div>
                      <div class="custom-select-option" data-value="Australia/Sydney">悉尼时间 (GMT+10)</div>
                      <div class="custom-select-option" data-value="Australia/Melbourne">墨尔本时间 (GMT+10)</div>
                      <div class="custom-select-option" data-value="Pacific/Auckland">奥克兰时间 (GMT+12)</div>
                      <div class="custom-select-option" data-value="Africa/Cairo">开罗时间 (GMT+2)</div>
                      <div class="custom-select-option" data-value="Africa/Johannesburg">约翰内斯堡时间 (GMT+2)</div>
                      <div class="custom-select-option" data-value="Africa/Lagos">拉各斯时间 (GMT+1)</div>
                    </div>
                    <input type="hidden" id="timezoneSelect" value="Asia/Shanghai">
                  </div>
                </div>
                <div class="settings-block">
                  <h3 data-i18n="presetTitle">配色</h3>
                  <div class="preset-grid">
                    <button class="preset" type="button" data-preset="gold">
                      <span></span><span></span><span></span>
                      <strong data-i18n="presetGold">雅金</strong>
                    </button>
                    <button class="preset" type="button" data-preset="linen">
                      <span></span><span></span><span></span>
                      <strong data-i18n="presetLinen">雾白</strong>
                    </button>
                    <button class="preset" type="button" data-preset="sage">
                      <span></span><span></span><span></span>
                      <strong data-i18n="presetSage">杉绿</strong>
                    </button>
                    <button class="preset" type="button" data-preset="noir">
                      <span></span><span></span><span></span>
                      <strong data-i18n="presetNoir">夜影</strong>
                    </button>
                    <button class="preset" type="button" data-preset="ember">
                      <span></span><span></span><span></span>
                      <strong data-i18n="presetEmber">暮火</strong>
                    </button>
                    <button class="preset" type="button" data-preset="ocean">
                      <span></span><span></span><span></span>
                      <strong data-i18n="presetOcean">海蓝</strong>
                    </button>
                  </div>
                </div>
                <div class="settings-block">
                  <h3 data-i18n="themeTitle">自定义颜色</h3>
                  <label class="color-field">
                    <span data-i18n="primaryColor">主色</span>
                    <input id="primaryColor" type="color" />
                  </label>
                  <label class="color-field">
                    <span data-i18n="accentColor">强调色</span>
                    <input id="accentColor" type="color" />
                  </label>
                  <label class="color-field">
                    <span data-i18n="backgroundColor">背景色</span>
                    <input id="backgroundColor" type="color" />
                  </label>
                  <button class="ghost" id="saveTheme" type="button" data-i18n="saveTheme">保存当前配色</button>
                </div>
                <div class="settings-block">
                  <h3 data-i18n="storageTitle">数据存储</h3>
                  <p class="drawer-note" data-i18n="storageHint">所有任务与设置仅保存在本机，不会上传。</p>
                </div>
              </div>
            </section>
          </div>
        </main>
      </div>
    </div>

    <script type="module" src="src/pages/settings.js"></script>
  </body>
</html>
