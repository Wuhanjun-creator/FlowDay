<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>习惯跟踪 - FlowDay</title>
    <link rel="stylesheet" href="styles.css" />
    <script>
      // 预加载主题 - 在页面渲染前应用，防止闪烁
      (function() {
        const cachedTheme = localStorage.getItem('flowday-current-theme');
        if (cachedTheme) {
          try {
            const theme = JSON.parse(cachedTheme);
            const root = document.documentElement;
            root.style.setProperty('--bg', theme.background);
            root.style.setProperty('--primary', theme.primary);
            root.style.setProperty('--accent', theme.accent);
            // 计算派生颜色
            const isDark = parseInt(theme.background.replace('#', ''), 16) < 0x888888;
            root.style.setProperty('--text', isDark ? '#f5f5f5' : '#111111');
            root.style.setProperty('--muted', isDark ? '#a1a1aa' : '#6b7280');
            root.style.setProperty('--panel', isDark ? 'rgba(255,255,255,0.06)' : 'rgba(255,255,255,0.7)');
            root.style.setProperty('--panel-strong', isDark ? 'rgba(255,255,255,0.1)' : 'rgba(255,255,255,0.92)');
            root.style.setProperty('--panel-deep', isDark ? '#0f0f0f' : '#e6e4dc');
            root.style.setProperty('--border', isDark ? 'rgba(255,255,255,0.08)' : 'rgba(0,0,0,0.08)');
            root.style.setProperty('--accent-soft', theme.accent + '40');
            root.style.setProperty('--glow', theme.accent + '26');
            root.style.setProperty('--button-solid', isDark ? '#ffffff' : '#111111');
            root.style.colorScheme = isDark ? 'dark' : 'light';
          } catch (e) {}
        }
      })();
    </script>
  </head>
  <body class="page-app">
    <div class="ambient" aria-hidden="true">
      <span class="orb orb-a"></span>
      <span class="orb orb-b"></span>
      <span class="orb orb-c"></span>
    </div>

    <div class="app-shell">
      <aside class="sidebar">
        <div class="brand">
          <div class="brand-mark">FlowDay</div>
          <div class="brand-tagline tagline-rotator tagline-small">
            <span>让每一天<br />在正确的节律中慢慢<br />绽放。</span>
            <span>Let every day <br bloom slowly,<br />in the right rhythm.</span>
          </div>
        </div>
        <nav class="nav" aria-label="primary">
          <a href="overview.html" class="nav-item" data-nav="overview">
            <span data-i18n="navOverview">今日概览</span>
          </a>
          <a href="insights.html" class="nav-item" data-nav="insights">
            <span data-i18n="navInsights">节奏洞察</span>
          </a>
          <a href="journal.html" class="nav-item" data-nav="journal">
            <span data-i18n="navJournal">记录今日</span>
          </a>
          <a href="habits.html" class="nav-item active" data-nav="habits">
            <span data-i18n="navHabits">习惯跟踪</span>
          </a>
          <a href="quicklist.html" class="nav-item" data-nav="quicklist">
            <span data-i18n="navQuicklist">即时清单</span>
          </a>
          <a href="settings.html" class="nav-item" data-nav="settings">
            <span data-i18n="navSettings">应用设置</span>
          </a>
        </nav>
      </aside>

      <div class="app-main">
        <header class="topbar">
          <div class="welcome-block">
            <h2 class="greeting" id="greeting"></h2>
            <div class="date-value" id="dateLabel"></div>
          </div>
        </header>

        <main class="content">
          <div class="page page-habits active">
            <div class="habits-body">
              <section class="card habits">
                <div class="card-head">
                  <h2 data-i18n="habitsTitle">习惯跟踪</h2>
                </div>
                <div class="habits-form">
                  <input type="text" id="habitInput" placeholder="添加新习惯..." />
                  <button class="solid" id="addHabit" data-i18n="addHabit">添加</button>
                </div>
                <ul class="habits-list" id="habitsList"></ul>
                <div class="empty" id="habitsEmpty" data-i18n="habitsEmpty">还没有习惯，开始添加吧</div>
              </section>

              <section class="card streaks">
                <div class="card-head">
                  <h2 data-i18n="streaksTitle">连续天数</h2>
                </div>
                <div class="streaks-list" id="streaksList"></div>
                <div class="empty" id="streaksEmpty" data-i18n="streaksEmpty">还没有习惯数据</div>
              </section>
            </div>
          </div>
        </main>
      </div>
    </div>

    <script type="module" src="src/pages/habits.js"></script>
  </body>
</html>
